(function(){window.MetaphorJs={lib:{}};var v=Array.prototype.slice,M=MetaphorJs.isPlainObject=function(k){return!(!k||k.constructor!==Object)},P=MetaphorJs.extend=function c(){var e=!1,g=!1,a=v.call(arguments),b=a.shift(),l,d,t;"boolean"==typeof a[a.length-1]&&(e=a.pop());"boolean"==typeof a[a.length-1]&&(g=e,e=a.pop());for(;a.length;)if(l=a.shift())for(d in l)if(l.hasOwnProperty(d)&&"undefined"!=typeof(t=l[d]))if(g)if(b[d]&&M(b[d])&&M(t))c(b[d],t,e,g);else{if(!0===e||"undefined"==typeof b[d]||null===
b[d])M(t)?(b[d]={},c(b[d],t,e,!0)):b[d]=t}else if(!0===e||"undefined"==typeof b[d]||null===b[d])b[d]=t;return b},k=MetaphorJs.bind=Function.prototype.bind?function(c,e){return c.bind(e)}:function(c,e){return function(){return c.apply(e,arguments)}},H=MetaphorJs.addListener=function(c,e,g){c.attachEvent?c.attachEvent("on"+e,g):c.addEventListener(e,g,!1)},S=MetaphorJs.trim=function(){return String.prototype.trim?function(c){return"string"==typeof c?c.trim():c}:function(c){return"string"==typeof c?c.replace(/^\s\s*/,
"").replace(/\s\s*$/,""):c}}(),$=Object.prototype.toString,V=MetaphorJs.isArray=function(c){return!(!c||"object"!=typeof c||"number"!=typeof c.length||"[object Array]"!=$.call(c))},R=MetaphorJs.toArray=function(c){if(c&&void 0!=c.length&&"string"!=typeof c){for(var e=[],g=-1,a=c.length>>>0;++g!==a;e[g]=c[g]);return e}return c?[c]:[]},X=MetaphorJs.select=function(){var c=/^[\w[:#.][\w\]*^|=!]*$/,e=/=([^\]]+)/,g=/ *, */,a=/(\([^)]*)\+/,b=/(\[[^\]]+)~/,l=/(~|>|\+)/,d=/ +/,t=/([^[:.#]+)?(?:#([^[:.#]+))?(?:\.([^[:.]+))?(?:\[([^!&^*|$[:=]+)([!$^*|&]?=)?([^:\]]+)?\])?(?::([^(]+)(?:\(([^)]+)\))?)?/,
s=/(?:(-?\d*)n)?(?:(%|-)(\d*))?/,aa=/\D/,E=/[^(]*\(([^)]*)\)/,A=/\(.*/,k=/\[([^!~^*|$ [:=]+)([$^*|]?=)?([^ :\]]+)?\]/,w=document,ba=!!w.getElementsByClassName,N=!!w.querySelectorAll,C={"first-child":function(a){return a.parentNode.getElementsByTagName("*")[0]!==a},"last-child":function(a){for(;(a=a.nextSibling)&&1!=a.nodeType;);return!!a},root:function(a){return"html"!==a.nodeName.toLowerCase()},"nth-child":function(a,h){var f=a.nodeIndex||0,t=h[3]=h[3]?("%"===h[2]?-1:1)*h[3]:0,b=h[1];if(f)return!((f+
t)%b);var s=a.parentNode.firstChild;f++;do if(1==s.nodeType&&(s.nodeIndex=++f)&&a===s&&(f+t)%b)return 0;while(s=s.nextSibling);return 1},"nth-last-child":function(a,h){var f=a.nodeIndexLast||0,t=h[3]?("%"===h[2]?-1:1)*h[3]:0,b=h[1];if(f)return!((f+t)%b);var s=a.parentNode.lastChild;f++;do if(1==s.nodeType&&(s.nodeLastIndex=f++)&&a===s&&(f+t)%b)return 0;while(s=s.previousSibling);return 1},empty:function(a){return!!a.firstChild},parent:function(a){return!a.firstChild},"only-child":function(a){return 1!=
a.parentNode.getElementsByTagName("*").length},checked:function(a){return!a.checked},lang:function(a,h){return a.lang!==h&&w.documentElement.lang!==h},enabled:function(a){return a.disabled||"hidden"===a.type},disabled:function(a){return!a.disabled},selected:function(a){return!a.selected}},r={},v=function(a){return r[a]||(r[a]=new RegExp("(^| +)"+a+"($| +)"))},x={"":function(a,h){return!!a.getAttribute(h)},"=":function(a,h,f){return(h=a.getAttribute(h))&&h===f},"&=":function(a,h,f){return(h=a.getAttribute(h))&&
v(f).test(h)},"^=":function(a,h,f){return(h=a.getAttribute(h)+"")&&!h.indexOf(f)},"$=":function(a,h,f){return(h=a.getAttribute(h)+"")&&h.indexOf(f)==h.length-f.length},"*=":function(a,h,f){return(h=a.getAttribute(h)+"")&&-1!=h.indexOf(f)},"|=":function(a,h,f){return(h=a.getAttribute(h)+"")&&(h===f||!!h.indexOf(f+"-"))},"!=":function(a,h,f){return!(h=a.getAttribute(h))||!v(f).test(h)}};return function(r,h){h=h||w;var f=[],n=null,u,B,F,m,G,y,z;if(N)try{f=R(h.querySelectorAll(r.replace(e,'="$1"')))}catch(v){n=
!0}if(!N||n)if(c.test(r))switch(n=0,r.charAt(0)){case "#":n=r.slice(1);f=w.getElementById(n);f.id!==n&&(f=w.all[n]);f=f?[f]:[];break;case ".":u=r.slice(1);if(ba)f=R((f=h.getElementsByClassName(u)).length?f:[]);else{u=" "+u+" ";B=h.getElementsByTagName("*");for(F=0;m=B[F++];)-1!=(" "+m.className+" ").indexOf(u)&&(f[n++]=m);f=n?f:[]}break;case ":":B=h.getElementsByTagName("*");F=0;G=r.replace(E,"$1");for(y=r.replace(A,"");m=B[F++];)C[y]&&!C[y](m,G)&&(f[n++]=m);f=n?f:[];break;case "[":B=h.getElementsByTagName("*");
F=0;m=k.exec(r);u=m[1];z=m[2]||"";for(G=m[3];m=B[F++];)x[z]&&(x[z](m,u,G)||"class"===u&&x[z](m,"className",G))&&(f[n++]=m);f=n?f:[];break;default:f=R((f=h.getElementsByTagName(r)).length?f:[])}else{for(var H=r.split(g),D=H.length-1,O=!!D,P,M,q,Q,I,J,K,L,S,p,T,U;n=H[D--];){M=(P=n.replace(a,"$1%").replace(b,"$1&").replace(l," $1 ").split(d)).length;F=0;Q=" ";for(B=[h];q=P[F++];)if(" "!==q&&">"!==q&&"~"!==q&&"+"!==q&&B){q=q.match(t);I=q[1]||"*";J=q[2];K=q[3]?" "+q[3]+" ":"";u=q[4];z=q[5]||"";y=q[7];
G="nth-child"===y||"nth-last-child"===y?s.exec("even"===q[8]&&"2n"||"odd"===q[8]&&"2n%1"||!aa.test(q[8])&&"0n%"+q[8]||q[8]):q[8];L=[];n=S=0;for(T=F==M;p=B[S++];)switch(Q){case " ":U=p.getElementsByTagName(I);for(p=0;m=U[p++];)J&&m.id!==J||K&&-1==(" "+m.className+" ").indexOf(K)||!(!u||x[z]&&(x[z](m,u,q[6])||"class"===u&&x[z](m,"className",q[6])))||m.yeasss||(C[y]?C[y](m,G):y)||(T&&(m.yeasss=1),L[n++]=m);break;case "~":for(I=I.toLowerCase();(p=p.nextSibling)&&!p.yeasss;)1!=p.nodeType||"*"!==I&&p.nodeName.toLowerCase()!==
I||J&&p.id!==J||K&&-1==(" "+p.className+" ").indexOf(K)||!(!u||x[z]&&(x[z](m,u,q[6])||"class"===u&&x[z](m,"className",q[6])))||p.yeasss||(C[y]?C[y](p,G):y)||(T&&(p.yeasss=1),L[n++]=p);break;case "+":for(;(p=p.nextSibling)&&1!=p.nodeType;);!p||p.nodeName.toLowerCase()!==I.toLowerCase()&&"*"!==I||J&&p.id!==J||K&&-1==(" "+m.className+" ").indexOf(K)||!(!u||x[z]&&(x[z](m,u,q[6])||"class"===u&&x[z](m,"className",q[6])))||p.yeasss||(C[y]?C[y](p,G):y)||(T&&(p.yeasss=1),L[n++]=p);break;case ">":for(U=p.getElementsByTagName(I),
F=0;m=U[F++];)m.parentNode!==p||J&&m.id!==J||K&&-1==(" "+m.className+" ").indexOf(K)||!(!u||x[z]&&(x[z](m,u,q[6])||"class"===u&&x[z](m,"className",q[6])))||m.yeasss||(C[y]?C[y](m,G):y)||(T&&(m.yeasss=1),L[n++]=m)}B=L}else Q=q;if(O){if(!B.concat){L=[];for(p=0;m=B[p];)L[p++]=m;B=L}f=B.concat(1==f.length?f[0]:f)}else f=B}for(n=f.length;n--;)f[n].yeasss=f[n].nodeIndex=f[n].nodeIndexLast=null}return f}}(),Q=MetaphorJs.emptyFn=function(){},Y=function(c,e){var g,a;if(!c||"string"!==typeof c)return null;
try{a=new DOMParser,g=a.parseFromString(c,e||"text/xml")}catch(b){g=void 0}if(!g||g.getElementsByTagName("parsererror").length)throw"Invalid XML: "+c;return g},Z=MetaphorJs.async=function(c,e,g){setTimeout(function(){c.apply(e,g||[])},0)},D=MetaphorJs.isThenable=function(c){var e;return!c||"object"!=typeof c&&"function"!=typeof c?!1:"function"==typeof(e=c.then)?e:!1};(function(){var c=[],e=!1,g="undefined"!=typeof process?process.nextTick:function(a){setTimeout(a,0)},a=function(){e=!0;var t=c.shift();
g(function(){t[0].apply(t[1],t[2]);c.length?a():e=!1},0)},b=function(t,b,d){d=d||[];c.push([t,b,d]);e||a()},l=function(a,b){return function(d){try{b.resolve(a(d))}catch(l){b.reject(l)}}},d=function(a,b){if(a instanceof d)return a;if(!(this instanceof d))return new d(a,b);this._fulfills=[];this._rejects=[];this._dones=[];this._fails=[];if("undefined"!=typeof a)if(D(a)||"function"!=typeof a)this.resolve(a);else try{a.call(b,k(this.resolve,this),k(this.reject,this))}catch(l){this.reject(l)}};d.prototype=
{_state:0,_fulfills:null,_rejects:null,_dones:null,_fails:null,_wait:0,_value:null,_reason:null,_triggered:!1,isPending:function(){return 0==this._state},isFulfilled:function(){return 1==this._state},isRejected:function(){return 2==this._state},_cleanup:function(){delete this._fulfills;delete this._rejects;delete this._dones;delete this._fails},_processValue:function(a,b){var l;if(0==this._state)if(a===this)this._doReject(new TypeError("cannot resolve promise with itself"));else{try{if(l=D(a)){a instanceof
d?a.then(k(this._processResolveValue,this),k(this._processRejectReason,this)):(new d(l,a)).then(k(this._processResolveValue,this),k(this._processRejectReason,this));return}}catch(c){0==this._state&&this._doReject(c);return}b.call(this,a)}},_callResolveHandlers:function(){this._done();for(var a=this._fulfills,d;d=a.shift();)b(d[0],d[1],[this._value]);this._cleanup()},_doResolve:function(a){this._value=a;this._state=1;0==this._wait&&this._callResolveHandlers()},_processResolveValue:function(a){this._processValue(a,
this._doResolve)},resolve:function(a){if(this._triggered)return this;this._triggered=!0;this._processResolveValue(a);return this},_callRejectHandlers:function(){this._fail();for(var a=this._rejects,d;d=a.shift();)b(d[0],d[1],[this._reason]);this._cleanup()},_doReject:function(a){this._state=2;this._reason=a;0==this._wait&&this._callRejectHandlers()},_processRejectReason:function(a){this._processValue(a,this._doReject)},reject:function(a){if(this._triggered)return this;this._triggered=!0;this._processRejectReason(a);
return this},then:function(a,s){var c=new d,e=this._state;0==e||0!=this._wait?(a&&"function"==typeof a?this._fulfills.push([l(a,c),null]):this._fulfills.push([c.resolve,c]),s&&"function"==typeof s?this._rejects.push([l(s,c),null]):this._rejects.push([c.reject,c])):1==e?a&&"function"==typeof a?b(l(a,c),null,[this._value]):c.resolve(this._value):2==e&&(s&&"function"==typeof s?b(l(s,c),null,[this._reason]):c.reject(this._reason));return c},"catch":function(a){return this.then(null,a)},_done:function(){for(var a=
this._dones,b;b=a.shift();)b[0].call(b[1]||null,this._value)},done:function(a,b){var d=this._state;1==d&&0==this._wait?a.call(b||null,this._value):0==d&&this._dones.push([a,b]);return this},_fail:function(){for(var a=this._fails,b;b=a.shift();)b[0].call(b[1]||null,this._reason)},fail:function(a,b){var d=this._state;2==d&&0==this._wait?a.call(b||null,this._reason):0==d&&this._fails.push([a,b]);return this},always:function(a,b){this.done(a,b);this.fail(a,b);return this},promise:function(){return{then:k(this.then,
this),done:k(this.done,this),fail:k(this.fail,this),always:k(this.always,this)}},after:function(a){var b=this;if(D(a)){b._wait++;var d=function(){b._wait--;0==b._wait&&0!=b._state&&(1==b._state?b._callResolveHandlers():b._callRejectHandlers())};"function"==typeof a.done?a.done(d):a.then(d)}return b}};d.resolve=function(a){return new d(a)};d.reject=function(a){var b=new d;b.reject(a);return b};d.all=function(a){if(!a.length)return d.resolve(null);var b=new d,l=a.length,c=Array(l),e=l,g,w,k=function(a,
d){c[d]=a;e--;0==e&&b.resolve(c)};for(g=0;g<l;g++)(function(l){w=a[g];w instanceof d?w.done(function(a){k(a,l)}).fail(b.reject,b):D(w)||"function"==typeof w?(new d(w)).done(function(a){k(a,l)}).fail(b.reject,b):k(w,l)})(g);return b};d.when=function(){return d.all(arguments)};d.allResolved=function(a){if(!a.length)return d.resolve(null);var b=new d,l=a.length,c=[],e=l,g,k,v=function(a){c.push(a);N()},N=function(){e--;0==e&&b.resolve(c)};for(g=0;g<l;g++)k=a[g],k instanceof d?k.done(v).fail(N):D(k)||
"function"==typeof k?(new d(k)).done(v).fail(N):v(k);return b};d.race=function(a){if(!a.length)return d.resolve(null);var b=new d,l=a.length,c,e;for(c=0;c<l&&(e=a[c],e instanceof d?e.done(b.resolve,b).fail(b.reject,b):D(e)||"function"==typeof e?(new d(e)).done(b.resolve,b).fail(b.reject,b):b.resolve(e),b.isPending());c++);return b};MetaphorJs.lib.Promise=d})();var O=MetaphorJs.lib.Promise,ca=MetaphorJs.nextUid=function(){var c=["0","0","0"];return function(){for(var e=c.length,g;e;){e--;g=c[e].charCodeAt(0);
if(57==g)return c[e]="A",c.join("");if(90==g)c[e]="0";else return c[e]=String.fromCharCode(g+1),c.join("")}c.unshift("0");return c.join("")}}();(function(){var c=function(){this.events={}};c.prototype={createEvent:function(a,b){a=a.toLowerCase();var l=this.events;l[a]||(l[a]=new e(a,b));return l[a]},getEvent:function(a){a=a.toLowerCase();return this.events[a]},on:function(a,b,l,d){a=a.toLowerCase();var c=this.events;c[a]||(c[a]=new e(a));return c[a].on(b,l,d)},once:function(a,b,c,d){d=d||{};d.limit=
1;return this.on(a,b,c,d)},un:function(a,b,c){a=a.toLowerCase();var d=this.events;d[a]&&d[a].un(b,c)},hasListener:function(a,b,c){a=a.toLowerCase();var d=this.events;return d[a]?d[a].hasListener(b,c):!1},removeAllListeners:function(a){var b=this.events;b[a]&&b[a].removeAllListeners()},triggerAsync:function(){var a=arguments[0],b=this.events,a=a.toLowerCase();if(!b[a])return[];a=b[a];return a.triggerAsync.apply(a,v.call(arguments,1))},trigger:function(){var a=arguments[0],b=this.events,a=a.toLowerCase();
if(!b[a])return null;a=b[a];return a.trigger.apply(a,v.call(arguments,1))},suspendEvent:function(a){a=a.toLowerCase();var b=this.events;b[a]&&b[a].suspend()},suspendAllEvents:function(){var a=this.events,b;for(b in a)a[b].suspend()},resumeEvent:function(a){a=a.toLowerCase();var b=this.events;b[a]&&b[a].resume()},resumeAllEvents:function(){var a=this.events,b;for(b in a)a[b].resume()},destroyEvent:function(a){var b=this.events;b[a]&&(b[a].removeAllListeners(),b[a].destroy(),delete b[a])},destroy:function(a){var b=
this.events;if(a)a=a.toLowerCase(),b[a]&&(b[a].destroy(),delete b[a]);else{for(var c in b)b[c].destroy();this.events={}}},getApi:function(){if(!this.api){for(var a="createEvent getEvent on un once hasListener removeAllListeners triggerAsync trigger suspendEvent suspendAllEvents resumeEvent resumeAllEvents destroyEvent".split(" "),b={},c,d=-1,e=a.length;++d<e;c=a[d],b[c]=k(this[c],this));this.api=b}return this.api}};var e=function(a,b){this.name=a;this.listeners=[];this.map={};this.hash=ca();this.uni=
"$$"+a+"_"+this.hash;this.suspended=!1;this.lid=0;this.returnResult=b||!1};e.prototype={getName:function(){return this.name},destroy:function(){this.map=this.listeners=null},on:function(a,b,c){if(!a)return null;b=b||null;c=c||{};var d=this.uni,e=b||a;if(e[d]&&!c.allowDupes)return null;var g=++this.lid,k=c.first||!1;e[d]=g;a={fn:a,scope:b,uniScope:e,id:g,called:0,limit:c.limit||0,start:c.start||1,count:0,append:c.append,prepend:c.prepend};k?this.listeners.unshift(a):this.listeners.push(a);this.map[g]=
a;return g},once:function(a,b,c){c=c||{};c.once=!0;return this.on(a,b,c)},un:function(a,b){var c=-1,d=this.uni,e=this.listeners,g;g=a==parseInt(a)?a:(b||a)[d];if(!g)return!1;for(var k=0,v=e.length;k<v;k++)if(e[k].id==g){c=k;delete e[k].uniScope[d];break}if(-1==c)return!1;e.splice(c,1);delete this.map[g];return!0},hasListener:function(a,b){var c=this.listeners,d;if(a){d="function"!=typeof a?a:(b||a)[this.uni];if(!d)return!1;for(var e=0,g=c.length;e<g;e++)if(c[e].id==d)return!0;return!1}return 0<c.length},
removeAllListeners:function(){var a=this.listeners,b=this.uni,c,d;c=0;for(d=a.length;c<d;c++)delete a[c].uniScope[b];this.listeners=[];this.map={}},suspend:function(){this.suspended=!0},resume:function(){this.suspended=!1},_prepareArgs:function(a,b){var c;a.append||a.prepend?(c=v.call(b),a.prepend&&(c=a.prepend.concat(c)),a.append&&(c=c.concat(a.append))):c=b;return c},triggerAsync:function(){if("undefined"==typeof O)throw Error("Promises are not defined");var a=this,b=a.listeners,c=a.returnResult,
d=v.call(arguments),e=[],g=[],k,E,A;if(a.suspended||0==b.length)return O.resolve(null);E=0;for(A=b.length;E<A;E++)e.push(b[E]);for(E=function(b){k=a._prepareArgs(b,d);return new O(function(c,d){Z(function(){try{c(b.fn.apply(b.scope,k))}catch(e){d(e)}b.called++;b.called==b.limit&&a.un(b.id)},0)})};(b=e.shift())&&(!b||!a.map[b.id]||(b.count++,b.count<b.start||(g.push(E(b)),"first"!=c))););return"last"==c?[g.pop()]:g},trigger:function(){var a=this.listeners,b=this.returnResult;if(this.suspended||0==
a.length)return null;for(var c="all"==b?[]:null,d,e,a="first"==b?[a[0]]:v.call(a);d=a.shift();)if(d&&this.map[d.id]&&(d.count++,!(d.count<d.start))){e=d.fn.apply(d.scope,this._prepareArgs(d,arguments));d.called++;d.called==d.limit&&this.un(d.id);"all"==b&&c.push(e);if("first"==b)return e;"last"==b&&(c=e);if(!1==b&&!1===e)break}if(b)return c}};var g=new c;P(MetaphorJs,g.getApi(),!0,!1);MetaphorJs.lib.Observable=c})();var da=MetaphorJs.lib.Observable;(function(){var c=/#.*$/,e=/([?&])_=[^&]*/,g=/\?/,
a=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,b=/^(?:GET|HEAD)$/i,l=0,d=function(a,f,b){var c,e;if("string"==typeof a&&b)f.push(encodeURIComponent(b)+"="+encodeURIComponent(a));else if(V(a)&&b)for(c=0,e=a.length;c<e;c++)d(a[c],f,b+"["+c+"]");else if("object"==typeof a)for(c in a)a.hasOwnProperty(c)&&d(a[c],f,b?b+"["+c+"]":c)},t=function(a,f){a.replace(c,"");if(!1===f.cache){var n=(new Date).getTime();return e.test(a)?a.replace(e,"$1_="+n):a+(g.test(a)?"&":"?")+"_="+n}!f.data||window.FormData&&
f.data instanceof window.FormData||("string"!=typeof f.data?(n=[],d(f.data,n,null),n=n.join("&").replace(/%20/g,"+")):n=f.data,f.data=n,b.test(f.method)&&(a+=(g.test(a)?"&":"?")+f.data,f.data=null));return a},s={xml:"application/xml, text/xml",html:"text/html",script:"text/javascript, application/javascript",json:"application/json, text/javascript",text:"text/plain",_default:"*/*"},v={url:null,data:null,method:"GET",headers:null,username:null,password:null,cache:null,dataType:null,timeout:0,contentType:"application/x-www-form-urlencoded",
xhrFields:null,jsonp:!1,jsonpParam:null,jsonpCallback:null,transport:null,replace:!1,selector:null,form:null,beforeSend:null,progress:null,uploadProgress:null,processResponse:null,callbackScope:null},E={},A=new da,D=function(a){var b;b=eval;a&&(/^[^\S]*use strict/.test(a)?(b=document.createElement("script"),b.text=a,document.head.appendChild(b).parentNode.removeChild(b)):b(a))},w=function(a,b,c){var d,e;if("object"!=typeof a&&"function"!=typeof a&&c)d=document.createElement("input"),d.setAttribute("type",
"hidden"),d.setAttribute("name",c),d.setAttribute("value",a),b.appendChild(d);else if(V(a)&&c)for(d=0,e=a.length;d<e;d++)w(a[d],b,c+"["+d+"]");else if("object"==typeof a)for(d in a)a.hasOwnProperty(d)&&w(a[d],b,c?c+"["+d+"]":d)},M=function(a){for(var b,c,d="",e=0;e<a.elements.length;e++)if(b=a.elements[e],b.hasAttribute("name"))if(c="INPUT"===b.nodeName.toUpperCase()?b.getAttribute("type").toUpperCase():"TEXT","FILE"===c)for(c=0;c<b.files.length;d+="&"+encodeURIComponent(b.name)+"="+encodeURIComponent(b.files[c++].name));
else if("RADIO"!==c&&"CHECKBOX"!==c||b.checked)d+="&"+encodeURIComponent(b.name)+"="+encodeURIComponent(b.value);return d},N=function(a,b,c){var d=b?b.dataType:null;b=b?b.selector:null;if("string"!=typeof a)return a;c=c||"";if("xml"===d||!d&&0<=c.indexOf("xml"))return a=Y(S(a)),b?X(b,a):a;if("html"===d)return a=Y(a,"text/html"),b?X(b,a):a;if("fragment"==d){c=document.createDocumentFragment();d=document.createElement("div");for(d.innerHTML=a;d.firstChild;)c.appendChild(d.firstChild);return c}if("json"===
d||!d&&0<=c.indexOf("json"))return a=S(a),a="undefined"!=typeof JSON?JSON.parse(a):(new Function("return "+a))(),a;("script"===d||!d&&0<=c.indexOf("javascript"))&&D(a);return a+""},C=function(b){var c=a.exec(("undefined"!=typeof window?window.location.href:"").toLowerCase())||[],d=a.exec(b.url.toLowerCase());this._opt=b;b.crossDomain=!(!d||d[1]===c[1]&&d[2]===c[2]&&(d[3]||("http:"===d[1]?"80":"443"))===(c[3]||("http:"===c[1]?"80":"443")));c=new O;"iframe"!=b.transport||b.form?b.form&&(this._form=
b.form,"POST"!=b.method||"undefined"!=typeof window&&window.FormData||"iframe"==b.transport||(b.transport="iframe")):(this.createForm(),b.form=this._form);b.form&&"iframe"!=b.transport&&(b.data="POST"==b.method?new FormData(b.form):M(b.form));b.url=t(b.url,b);d=!b.crossDomain&&"script"!=b.transport||b.form?"iframe"==b.transport?new W(b,c,this):new R(b,c,this):new x(b,c,this);this._deferred=c;this._transport=d;c.done(function(a){A.trigger("success",a)});c.fail(function(a){A.trigger("error",a)});c.always(function(){A.trigger("end")});
A.trigger("start");b.timeout&&(this._timeout=setTimeout(k(this.onTimeout,this),b.timeout));b.jsonp&&this.createJsonp();!1===A.trigger("beforeSend",b,d)&&(this._promise=O.reject());b.beforeSend&&!1===b.beforeSend.call(b.callbackScope,b,d)&&(this._promise=O.reject());this._promise||(Z(d.send,d),c.abort=k(this.abort,this),c.always(this.destroy,this),this._promise=c)};C.prototype={_jsonpName:null,_transport:null,_opt:null,_deferred:null,_promise:null,_timeout:null,_form:null,_removeForm:!1,promise:function(){return this._promise},
abort:function(a){this._transport.abort();this._deferred.reject(a||"abort")},onTimeout:function(){this.abort("timeout")},createForm:function(){var a=document.createElement("form");a.style.display="none";a.setAttribute("method",this._opt.method);w(this._opt.data,a,null);document.body.appendChild(a);this._form=a;this._removeForm=!0},createJsonp:function(){var a=this._opt,b=a.jsonpParam||"callback",c=a.jsonpCallback||"jsonp_"+ ++l;a.url+=(g.test(a.url)?"&":"?")+b+"="+c;this._jsonpName=c;"undefined"!=
typeof window&&(window[c]=k(this.jsonpCallback,this));"undefined"!=typeof global&&(global[c]=k(this.jsonpCallback,this));return c},jsonpCallback:function(a){try{this._deferred.resolve(this.processResponseData(a))}catch(b){this._deferred.reject(b)}},processResponseData:function(a,b){var c=this._opt;a=N(a,c,b);A.hasListener("processResponse")&&(a=A.trigger("processResponse",a,this._deferred));c.processResponse&&(a=c.processResponse.call(c.callbackScope,a,this._deferred));return a},processResponse:function(a,
b){var c=this._deferred;if(this._opt.jsonp)if(a){try{D(a)}catch(d){c.reject(d)}c.isPending()&&c.reject("jsonp script didn't invoke callback")}else c.reject("jsonp script is empty");else try{c.resolve(this.processResponseData(a,b))}catch(e){c.reject(e)}},destroy:function(){this._timeout&&clearTimeout(this._timeout);this._form&&this._form.parentNode&&this._removeForm&&this._form.parentNode.removeChild(this._form);this._transport.destroy();delete this._transport;delete this._opt;delete this._deferred;
delete this._promise;delete this._timeout;delete this._form;this._jsonpName&&("undefined"!=typeof window&&delete window[this._jsonpName],"undefined"!=typeof global&&delete global[this._jsonpName])}};var r=function(a,b){b=b||{};a&&"string"!=typeof a?b=a:b.url=a;if(!b.url&&(b.form&&(b.url=b.form.getAttribute("action")),!b.url))throw"Must provide url";P(b,E,!1,!0);P(b,v,!1,!0);b.method=b.method?b.method.toUpperCase():b.form?b.form.getAttribute("method").toUpperCase()||"GET":"GET";return(new C(b)).promise()};
r.setup=function(a){P(E,a,!0,!0)};r.on=function(){A.on.apply(A,arguments)};r.un=function(){A.un.apply(A,arguments)};r.get=function(a,b){b=b||{};b.method="GET";return r(a,b)};r.post=function(a,b){b=b||{};b.method="POST";return r(a,b)};r.load=function(a,b,c){c=c||{};"string"!=typeof b&&(c=b);c.dataType="fragment";return r(b,c).done(function(b){if(c.replace)for(;a.firstChild;)a.removeChild(a.firstChild);a.appendChild(b)})};r.loadScript=function(a){return r(a,{transport:"script"})};r.submit=function(a,
b){b=b||{};b.form=a;return r(null,b)};var R=function(a,b,c){var d;if(!(window.XMLHttpRequest&&(d=new XMLHttpRequest)||(d=new ActiveXObject("Msxml2.XMLHTTP"))||(d=new ActiveXObject("Microsoft.XMLHTTP"))))throw"Unable to create XHR object";this._xhr=d;this._deferred=b;this._opt=a;this._ajax=c;a.progress&&H(d,"progress",k(a.progress,a.callbackScope));a.uploadProgress&&d.upload&&H(d.upload,"progress",k(a.uploadProgress,a.callbackScope));try{var e;if(a.xhrFields)for(e in a.xhrFields)d[e]=a.xhrFields[e];
a.data&&a.contentType&&d.setRequestHeader("Content-Type",a.contentType);d.setRequestHeader("X-Requested-With","XMLHttpRequest");d.setRequestHeader("Accept",a.dataType&&s[a.dataType]?s[a.dataType]+", */*; q=0.01":s._default);for(e in a.headers)d.setRequestHeader(e,a.headers[e])}catch(g){}d.onreadystatechange=k(this.onReadyStateChange,this)};R.prototype={_xhr:null,_deferred:null,_ajax:null,onReadyStateChange:function(){var a=this._xhr,b=this._deferred;if(0===a.readyState)a.onreadystatechange=Q,b.resolve(a);
else if(4===a.readyState){a.onreadystatechange=Q;var c;a:{try{c=!a.status&&"undefined"!=typeof location&&"file:"==location.protocol||200<=a.status&&300>a.status||304===a.status||1223===a.status;break a}catch(d){}c=!1}c?this._ajax.processResponse("string"==typeof a.responseText?a.responseText:void 0,a.getResponseHeader("content-type")||""):b.reject(a)}},abort:function(){this._xhr.onreadystatechange=Q;this._xhr.abort()},send:function(){var a=this._opt;try{this._xhr.open(a.method,a.url,!0,a.username,
a.password),this._xhr.send(a.data)}catch(b){this._deferred.reject(b)}},destroy:function(){delete this._xhr;delete this._deferred;delete this._opt;delete this._ajax}};var x=function(a,b,c){this._opt=a;this._ajax=c;this._deferred=b};x.prototype={_opt:null,_deferred:null,_ajax:null,_el:null,send:function(){var a=document.createElement("script");a.setAttribute("async","async");a.setAttribute("charset","utf-8");a.setAttribute("src",this._opt.url);H(a,"load",k(this.onLoad,this));H(a,"error",k(this.onError,
this));document.head.appendChild(a);this._el=a},onLoad:function(a){this._deferred&&this._deferred.resolve(a)},onError:function(a){this._deferred.reject(a)},abort:function(){this._el.parentNode&&this._el.parentNode.removeChild(this._el)},destroy:function(){this._el.parentNode&&this._el.parentNode.removeChild(this._el);delete this._el;delete this._opt;delete this._ajax;delete this._deferred}};var W=function(a,b,c){this._opt=a;this._ajax=c;this._deferred=b};W.prototype={_opt:null,_deferred:null,_ajax:null,
_el:null,send:function(){var a=document.createElement("iframe"),b="frame-"+ ++l,c=this._opt.form;a.setAttribute("id",b);a.setAttribute("name",b);a.style.display="none";document.body.appendChild(a);c.setAttribute("action",this._opt.url);c.setAttribute("target",b);H(a,"load",k(this.onLoad,this));H(a,"error",k(this.onError,this));this._el=a;try{c.submit()}catch(d){this._deferred.reject(d)}},onLoad:function(){var a=this._el;this._opt&&!this._opt.jsonp&&(a=a.contentDocument||a.contentWindow.document,a=
a.body.innerHTML,this._ajax.processResponse(a))},onError:function(a){this._deferred.reject(a)},abort:function(){this._el.parentNode&&this._el.parentNode.removeChild(this._el)},destroy:function(){this._el.parentNode&&this._el.parentNode.removeChild(this._el);delete this._el;delete this._opt;delete this._ajax;delete this._deferred}};MetaphorJs.ajax=r})()})();
